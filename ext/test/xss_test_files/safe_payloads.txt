# ğŸ›¡ï¸ Safe Payload Documentation

**Purpose**: Document the safe payload patterns used in XSS test files
**Status**: Non-malicious patterns only
**Last Updated**: 2026-02-10

---

## ğŸ“‹ Safe Payload Patterns

This document describes the **safe, harmless patterns** used in our XSS test files. These patterns demonstrate the vulnerability without containing any actual malicious code.

---

## ğŸ¯ Design Principles

### What Makes These Payloads Safe

1. **No JavaScript Execution**: No `<script>` tags or JS event handlers
2. **No Harmful Actions**: No data theft, no session access
3. **No External Resources**: No links to external domains
4. **No Code Execution**: No actual programming logic
5. **Harmless Content**: Only demonstration patterns

---

## ğŸ“Š Payload Categories

### 1. HTML-like Patterns

**Purpose**: Test if HTML content survives sanitization
**Pattern**: `<tag>content</tag>` embedded in block characters
**Safety**: Uses non-executable tags and safe content

**Examples:**
```
â—˜â–‘<b>test</b>â–“â–ˆ
â—˜â–‘<i>safe</i>â–“â–ˆ
â—˜â–‘<u>content</u>â–“â–ˆ
```

### 2. Attribute Patterns

**Purpose**: Test if attributes survive sanitization
**Pattern**: `<tag attr="value">` embedded in block characters
**Safety**: Uses harmless attributes only

**Examples:**
```
â—˜â–‘<span class="test">â–“â–ˆ
â—˜â–‘<div id="safe">â–“â–ˆ
â—˜â–‘<p style="color:red">â–“â–ˆ
```

### 3. Comment Patterns

**Purpose**: Test if comments survive sanitization
**Pattern**: `<!-- comment -->` embedded in block characters
**Safety**: Comments cannot execute code

**Examples:**
```
â—˜â–‘<!-- test -->â–“â–ˆ
â—˜â–‘<!-- safe comment -->â–“â–ˆ
```

### 4. Mixed Patterns

**Purpose**: Test complex sanitization scenarios
**Pattern**: Combination of HTML, attributes, and text
**Safety**: All components are harmless

**Examples:**
```
â—˜â–‘<b class="test">safe</b>â–“â–ˆ
â—˜â–‘<i id="demo">content</i>â–“â–ˆ
```

---

## ğŸ”¬ Technical Details

### Block Characters Used

The following block characters trigger the vulnerable regex pattern:
```
â—˜ â–‘ â–’ â–“ â–ˆ â–„ â– â–Œ â–€ â– 
```

### Regex Pattern Triggered

```javascript
/([â—˜â–‘â–’â–“â–ˆâ–„â–â–Œâ–€â– ]+)/g
```

This regex matches sequences of block characters, which is where the vulnerability occurs.

---

## ğŸ“ File-Specific Payloads

### wildcat_xss_test.txt

**Patterns Used:**
- Simple HTML tags in block characters
- Basic attribute patterns
- Comment patterns

**Example Content:**
```
This is a Wildcat BBS test file
â—˜â–‘<b>WILDCAT</b>â–“â–ˆ
â—˜â–‘<i>TEST</i>â–“â–ˆ
â—˜â–‘<!-- SAFE -->â–“â–ˆ
```

### celerity_xss_test.txt

**Patterns Used:**
- Celerity-specific formatting
- HTML patterns with BBS codes
- Mixed content patterns

**Example Content:**
```
Celerity BBS Test File
â—˜â–‘<span class="celerity">TEST</span>â–“â–ˆ
â—˜â–‘<div id="safe">CONTENT</div>â–“â–ˆ
```

### pipes_xss_test.txt

**Patterns Used:**
- Pipe code compatible patterns
- HTML in block character sequences
- Attribute testing patterns

**Example Content:**
```
Renegade Pipes Test
â—˜â–‘<b class="pipe">SAFE</b>â–“â–ˆ
â—˜â–‘<i id="test">DEMO</i>â–“â–ˆ
```

---

## ğŸ›¡ï¸ Safety Verification

### What These Payloads Cannot Do

âŒ **Execute JavaScript**: No script tags or event handlers
âŒ **Access Data**: No cookies, localStorage, or session access
âŒ **Make Requests**: No AJAX, fetch, or XHR calls
âŒ **Redirect Users**: No window.location changes
âŒ **Steal Information**: No data exfiltration attempts

### What These Payloads Can Do

âœ… **Test Sanitization**: Verify HTML handling
âœ… **Trigger Code Paths**: Activate vulnerable functions
âœ… **Demonstrate Patterns**: Show vulnerability characteristics
âœ… **Validate Fixes**: Confirm security patches work

---

## ğŸ”§ Payload Construction Rules

### Safe Payload Requirements

1. **No JavaScript**: No `<script>`, `on*=` attributes, or JS URIs
2. **No External Links**: No `href="http://..."` or similar
3. **No Data Access**: No attempts to access user data
4. **No Execution**: No code that could run in browser
5. **Clear Purpose**: Each payload tests specific behavior

### Example of Safe vs Unsafe

**âŒ Unsafe (would not include):**
```
<script>alert('XSS')</script>
<img src="x" onerror="malicious()">
<a href="javascript:steal()">click</a>
```

**âœ… Safe (what we include):**
```
<b>test</b>
<span class="safe">content</span>
<!-- comment -->
```

---

## ğŸ“Š Test Coverage Matrix

| Payload Type | wildcat | celerity | pipes | Purpose |
|--------------|---------|----------|-------|---------|
| Simple HTML tags | âœ… | âœ… | âœ… | Basic sanitization test |
| Attributes | âœ… | âœ… | âœ… | Attribute handling test |
| Comments | âœ… | âŒ | âŒ | Comment processing test |
| Mixed patterns | âŒ | âœ… | âœ… | Complex scenario test |
| BBS-specific | âŒ | âœ… | âœ… | Format-specific test |

---

## ğŸ”¬ Expected Behavior

### In Vulnerable Version

- HTML patterns may render as actual HTML elements
- Browser may show DOM elements in inspector
- No actual code execution occurs (safe payloads)
- Console may show sanitization warnings

### In Fixed Version

- All patterns render as plain text
- No HTML elements created
- Content appears exactly as in file
- No browser warnings or errors

---

## ğŸ› ï¸ Creating New Safe Payloads

### Step-by-Step Guide

1. **Identify Test Goal**: What specific behavior to test?
2. **Choose Block Characters**: Use â—˜â–‘â–’â–“â–ˆâ–„â–â–Œâ–€â–  to trigger regex
3. **Add Safe HTML**: Use only harmless tags/attributes
4. **Verify Safety**: Ensure no executable code
5. **Document Purpose**: Explain what this payload tests
6. **Test Thoroughly**: Confirm it's harmless

### Example Creation

**Goal**: Test if `<span>` with class attribute survives

**Safe Payload:**
```
â—˜â–‘<span class="test-payload">SAFE</span>â–“â–ˆ
```

**Verification:**
- âœ… No JavaScript
- âœ… No external resources
- âœ… No data access
- âœ… Harmless content
- âœ… Tests specific sanitization behavior

---

## ğŸ“… Maintenance Log

**v1.0** - Initial payload set
- Created safe patterns for all three vulnerable methods
- Established safety verification process
- Documented all payload types and rules

---

**Important**: Always verify that new payloads follow the safety rules and cannot be weaponized. When in doubt, err on the side of caution.
